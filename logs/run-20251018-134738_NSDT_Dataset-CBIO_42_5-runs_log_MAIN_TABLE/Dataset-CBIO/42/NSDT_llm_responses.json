[{"id": "chatcmpl-CS4NeMnMZJxLcBjS4n4gek9xPtyzj", "object": "chat.completion", "created": 1760806058, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": null, "function_call": {"name": "complete_StateDifferential_code", "arguments": "{\"StateDifferential_code\":\"import torch\\nimport torch.nn as nn\\nimport torch.nn.functional as F\\nfrom typing import Tuple\\n\\nclass StateDifferential(nn.Module):\\n\\tdef __init__(self):\\n\\t\\tsuper(StateDifferential, self).__init__()\\n\\t\\tself.mlp = nn.Sequential(\\n\\t\\t\\tnn.Linear(12, 256),\\n\\t\\t\\tnn.LayerNorm(256),\\n\\t\\t\\tnn.LeakyReLU(0.1),\\n\\t\\t\\tnn.Dropout(0.2),\\n\\t\\t\\tnn.Linear(256, 256),\\n\\t\\t\\tnn.LayerNorm(256),\\n\\t\\t\\tnn.LeakyReLU(0.1),\\n\\t\\t\\tnn.Dropout(0.2),\\n\\t\\t\\tnn.Linear(256, 64),\\n\\t\\t\\tnn.LeakyReLU(0.1),\\n\\t\\t\\tnn.Linear(64, 4)\\n\\t\\t)\\n\\t\\tself.treatment_gate = nn.Sequential(\\n\\t\\t\\tnn.Linear(12, 64),\\n\\t\\t\\tnn.LeakyReLU(0.1),\\n\\t\\t\\tnn.Linear(64, 1)\\n\\t\\t)\\n\\n\\tdef forward(self, inputs: Tuple[torch.Tensor]) -> Tuple[torch.Tensor]:\\n\\t\\t# Concatenate inputs\\n\\t\\tx = torch.cat(inputs, dim=-1)\\n\\t\\tassert x.shape[-1] == 12, \\\"Input must have last dimension of size 12\\\"\\n\\n\\t\\t# Compute derivatives\\n\\t\\tmlp_output = self.mlp(x)\\n\\t\\td_tumor_size__dt, d_msi_score__dt, d_tmb_nonsynonymous__dt, d_mitotic_rate__dt = mlp_output.split(1, dim=-1)\\n\\n\\t\\t# Compute treatment gate\\n\\t\\tgamma = F.softplus(self.treatment_gate(x))\\n\\n\\t\\t# Apply treatment effect\\n\\t\\td_tumor_size__dt = d_tumor_size__dt - gamma * inputs[11]  # treatment_duration\\n\\n\\t\\t# Clamp outputs to physiological ranges\\n\\t\\td_tumor_size__dt = d_tumor_size__dt.clamp(-5, 5)\\n\\t\\td_msi_score__dt = d_msi_score__dt.clamp(-1, 1)\\n\\t\\td_tmb_nonsynonymous__dt = d_tmb_nonsynonymous__dt.clamp(-0.05, 0.05)\\n\\t\\td_mitotic_rate__dt = d_mitotic_rate__dt.clamp(-10, 10)\\n\\n\\t\\t# Sanity checks\\n\\t\\tassert not torch.isnan(d_tumor_size__dt).any(), \\\"Output contains NaN\\\"\\n\\t\\tassert not torch.isinf(d_tumor_size__dt).any(), \\\"Output contains Inf\\\"\\n\\n\\t\\treturn d_tumor_size__dt, d_msi_score__dt, d_tmb_nonsynonymous__dt, d_mitotic_rate__dt\",\"code_description\":\"This code implements a neural ODE-like differential model for simulating treatment response in GIST, using a hybrid design of mechanistic prior and residual MLP correction.\"}"}, "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1757, "completion_tokens": 726, "total_tokens": 2483, "prompt_tokens_details": {"cached_tokens": 1664, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_560af6e559"}]